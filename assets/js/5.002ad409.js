(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{344:function(_,t,v){_.exports=v.p+"assets/img/report_history_3.6f1a08d5.png"},345:function(_,t,v){_.exports=v.p+"assets/img/report_history_4.ea86a2f2.png"},346:function(_,t,v){_.exports=v.p+"assets/img/report_allure_4.36d11995.png"},354:function(_,t,v){_.exports=v.p+"assets/img/global_config_env_1.d1bc8034.png"},445:function(_,t,v){_.exports=v.p+"assets/img/env_monitor_1.990256ac.png"},446:function(_,t,v){_.exports=v.p+"assets/img/env_monitor_2.e2207c9a.png"},447:function(_,t,v){_.exports=v.p+"assets/img/env_monitor_3.6afa6af7.png"},448:function(_,t,v){_.exports=v.p+"assets/img/env_monitor_4.34b3f93e.png"},449:function(_,t,v){_.exports=v.p+"assets/img/env_monitor_5.ed0ae79d.png"},504:function(_,t,v){"use strict";v.r(t);var a=v(31),s=Object(a.a)({},(function(){var _=this,t=_.$createElement,a=_._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":_.$parent.slotKey}},[a("h1",{attrs:{id:"环境监控、冒烟、巡检"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#环境监控、冒烟、巡检"}},[_._v("#")]),_._v(" 环境监控、冒烟、巡检")]),_._v(" "),a("p",[_._v("监控环境可用性状态，并以环境为单位执行冒烟测试、回归测试等。")]),_._v(" "),a("h2",{attrs:{id:"_1-背景"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-背景"}},[_._v("#")]),_._v(" 1. 背景")]),_._v(" "),a("h3",{attrs:{id:"_1-1-问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-问题"}},[_._v("#")]),_._v(" 1.1 问题")]),_._v(" "),a("ol",[a("li",[_._v("测试环境、QA环境等线下环境阻塞问题多，稳定性差，严重影响测试效率。")]),_._v(" "),a("li",[_._v("测试过程中遇到的部分BUG，无法判断是环境问题还是真实BUG。")]),_._v(" "),a("li",[_._v("暂无有效、快速、自动化的测试环境可用性验证手段。")]),_._v(" "),a("li",[_._v("现有测试用例大多依赖部分环境数据，对变化频繁、无数据的测试环境不友好。")])]),_._v(" "),a("h3",{attrs:{id:"_1-2-目的"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-目的"}},[_._v("#")]),_._v(" 1.2 目的")]),_._v(" "),a("ol",[a("li",[_._v("提供对测试环境服务可用性的验证方法，实现快速、自动化验证，并提供可用性验证结果。")]),_._v(" "),a("li",[_._v("解决数据依赖问题。")])]),_._v(" "),a("h2",{attrs:{id:"_2-实现方案"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-实现方案"}},[_._v("#")]),_._v(" 2. 实现方案")]),_._v(" "),a("p",[_._v("基于现有接口测试平台、接口测试用例，通过用例分级设计、分级运行、分级校验的方式，实现快速验证测试环境接口连通性。")]),_._v(" "),a("h3",{attrs:{id:"_2-1-用例分级设计"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-用例分级设计"}},[_._v("#")]),_._v(" 2.1 用例分级设计")]),_._v(" "),a("p",[_._v("用例类型分为：单接口测试、场景测试、setup、teardown，测试环境可用性验证执行但接口测试用例。")]),_._v(" "),a("ul",[a("li",[_._v("单接口测试\n"),a("ul",[a("li",[_._v("P0：核心接口正向用例")]),_._v(" "),a("li",[_._v("P1：核心接口异常用例")]),_._v(" "),a("li",[_._v("P2：非核心接口用例")])])]),_._v(" "),a("li",[_._v("场景测试")]),_._v(" "),a("li",[_._v("setup")]),_._v(" "),a("li",[_._v("teardown")])]),_._v(" "),a("h3",{attrs:{id:"_2-2-测试分级运行"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-测试分级运行"}},[_._v("#")]),_._v(" 2.2 测试分级运行")]),_._v(" "),a("ul",[a("li",[_._v("测试执行维度\n"),a("ul",[a("li",[_._v("用例集")]),_._v(" "),a("li",[_._v("用例")]),_._v(" "),a("li",[_._v("测试步骤")])])]),_._v(" "),a("li",[_._v("测试用例执行维度\n"),a("ul",[a("li",[_._v("单接口测试")]),_._v(" "),a("li",[_._v("场景测试")])])]),_._v(" "),a("li",[_._v("单接口测试用例执行维度\n"),a("ul",[a("li",[_._v("优先级P0")]),_._v(" "),a("li",[_._v("优先级P1")]),_._v(" "),a("li",[_._v("优先级P2")])])])]),_._v(" "),a("h3",{attrs:{id:"_2-3-响应分级校验"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-响应分级校验"}},[_._v("#")]),_._v(" 2.3 响应分级校验")]),_._v(" "),a("ul",[a("li",[_._v("响应状态码")]),_._v(" "),a("li",[_._v("响应json-schema")]),_._v(" "),a("li",[_._v("响应值内容")])]),_._v(" "),a("h3",{attrs:{id:"_2-4-有变更接口选择性执行"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-有变更接口选择性执行"}},[_._v("#")]),_._v(" 2.4. 有变更接口选择性执行")]),_._v(" "),a("p",[_._v("对于存在更新且未对用例进行维护的接口，进行选择性执行：")]),_._v(" "),a("ul",[a("li",[_._v("场景测试：遇到有更新待处理的接口请求步骤，停止测试，标记用例失败")]),_._v(" "),a("li",[_._v("非场景测试：遇到有更新待处理的接口请求步骤，继续测试，如步骤失败，continue(标记步骤失败并继续后续步骤执行)")])]),_._v(" "),a("h3",{attrs:{id:"_2-4-测试构建类型"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-测试构建类型"}},[_._v("#")]),_._v(" 2.4 测试构建类型")]),_._v(" "),a("p",[a("font",{attrs:{color:"#E6A23C"}},[a("strong",[_._v("接口测试->工作台->快速测试/业务巡检/冒烟测试/环境验证")])])],1),_._v(" "),a("h4",{attrs:{id:"_2-4-1-测试环境可用性验证"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-1-测试环境可用性验证"}},[_._v("#")]),_._v(" 2.4.1 测试环境可用性验证")]),_._v(" "),a("p",[_._v("通过执行并验证核心接口连通性，确保测试环境基本可用。即：")]),_._v(" "),a("ul",[a("li",[_._v("单接口测试用例")]),_._v(" "),a("li",[_._v("优先级P0")]),_._v(" "),a("li",[_._v("仅校验响应状态码\n"),a("img",{attrs:{src:v(445),alt:"An image"}})])]),_._v(" "),a("h4",{attrs:{id:"_2-4-2-冒烟测试"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-2-冒烟测试"}},[_._v("#")]),_._v(" 2.4.2 冒烟测试")]),_._v(" "),a("ul",[a("li",[_._v("单接口测试用例")]),_._v(" "),a("li",[_._v("优先级P0、P1")]),_._v(" "),a("li",[_._v("全部校验：响应状态码、响应值内容")])]),_._v(" "),a("h4",{attrs:{id:"_2-4-3-业务巡检"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-3-业务巡检"}},[_._v("#")]),_._v(" 2.4.3 业务巡检")]),_._v(" "),a("ul",[a("li",[_._v("全部用例：单接口测试用例、场景用例")]),_._v(" "),a("li",[_._v("全部校验：响应状态码、响应值内容")])]),_._v(" "),a("h4",{attrs:{id:"_2-4-4-其他-快速测试"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-4-其他-快速测试"}},[_._v("#")]),_._v(" 2.4.4 其他（快速测试）")]),_._v(" "),a("p",[_._v("灵活筛选用例执行，指定校验方式。")]),_._v(" "),a("h2",{attrs:{id:"_3-数据依赖处理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-数据依赖处理"}},[_._v("#")]),_._v(" 3. 数据依赖处理")]),_._v(" "),a("p",[_._v("现有测试用例大多依赖部分环境数据，对变化频繁、无数据的测试环境不友好，需要构造公共测试依赖数据。\n数据构造方式一般2种：")]),_._v(" "),a("ul",[a("li",[_._v("API构造")]),_._v(" "),a("li",[_._v("数据库插入")])]),_._v(" "),a("p",[_._v("这里选择API构造的方式。通过管理数据构造API请求集为setup用例，一个setup用例为一组数据构造请求集，供其他测试用例集调用。")]),_._v(" "),a("p",[_._v("调用方式：setup/teardown、setup_class/teardown_class\n"),a("img",{attrs:{src:v(446),alt:"An image"}})]),_._v(" "),a("h2",{attrs:{id:"_4-关联模块设计"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-关联模块设计"}},[_._v("#")]),_._v(" 4. 关联模块设计")]),_._v(" "),a("h3",{attrs:{id:"_4-1-全局配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-全局配置"}},[_._v("#")]),_._v(" 4.1 全局配置")]),_._v(" "),a("p",[_._v("https://qalab.company.com/#/api/apiTest/global")]),_._v(" "),a("h4",{attrs:{id:"_4-1-1-环境配置管理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-1-环境配置管理"}},[_._v("#")]),_._v(" 4.1.1 环境配置管理")]),_._v(" "),a("p",[_._v("在"),a("font",{attrs:{color:"#E6A23C"}},[a("strong",[_._v("接口测试->全局配置->环境配置")])]),_._v("处新增、管理测试环境。\n"),a("img",{attrs:{src:v(354),alt:"An image"}})],1),_._v(" "),a("h3",{attrs:{id:"_4-2-工作台"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-工作台"}},[_._v("#")]),_._v(" 4.2 工作台")]),_._v(" "),a("p",[_._v("https://qalab.company.com/#/api/apiTest/workbench")]),_._v(" "),a("h4",{attrs:{id:"_4-2-1-新增待验证环境"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-1-新增待验证环境"}},[_._v("#")]),_._v(" 4.2.1 新增待验证环境")]),_._v(" "),a("p",[_._v("在"),a("font",{attrs:{color:"#E6A23C"}},[a("strong",[_._v("接口测试->工作台->环境验证")])]),_._v("处新增一条待验证可用性的环境记录，\n主要目的为创建一条数据指定需要监控的环境，默认获取并关联最新一条该环境的环境验证测试报告，如果没有显示0（如下）。\n"),a("img",{attrs:{src:v(447),alt:"An image"}})],1),_._v(" "),a("h4",{attrs:{id:"_4-2-2-执行环境验证测试"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-2-执行环境验证测试"}},[_._v("#")]),_._v(" 4.2.2 执行环境验证测试")]),_._v(" "),a("p",[_._v("点击执行按钮，构建并执行环境可用性验证测试。默认执行方案：")]),_._v(" "),a("ul",[a("li",[_._v("单接口测试用例")]),_._v(" "),a("li",[_._v("测试步骤标签：优先级P0")]),_._v(" "),a("li",[_._v("仅校验响应状态码\n"),a("img",{attrs:{src:v(448),alt:"An image"}})])]),_._v(" "),a("h4",{attrs:{id:"_4-2-3-查看环境可用性结果"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-3-查看环境可用性结果"}},[_._v("#")]),_._v(" 4.2.3 查看环境可用性结果")]),_._v(" "),a("p",[a("img",{attrs:{src:v(449),alt:"An image"}}),_._v("\n显示最近一次执行结果分析，其中：")]),_._v(" "),a("ul",[a("li",[_._v("公司ID：对应环境公司ID")]),_._v(" "),a("li",[_._v("上次执行：最近一次执行时间，对应关联的测试报告执行时间")]),_._v(" "),a("li",[_._v("通过率\n"),a("ul",[a("li",[_._v("通过/总数")]),_._v(" "),a("li",[_._v("百分比+红/绿颜色展示")]),_._v(" "),a("li",[_._v("通过率==100%，绿色，可用")]),_._v(" "),a("li",[_._v("通过率<100%，红色，不可用")])])]),_._v(" "),a("li",[_._v("结果统计\n"),a("ul",[a("li",[_._v("总数：总测试请求步骤数")]),_._v(" "),a("li",[_._v("通过：响应校验通过")]),_._v(" "),a("li",[_._v("失败：响应校验失败")]),_._v(" "),a("li",[_._v("跳过：跳过未执行")]),_._v(" "),a("li",[_._v("故障：设计错误/代码错误")])])]),_._v(" "),a("li",[_._v("测试报告\n"),a("ul",[a("li",[_._v("pytest：pytest-html生成的报告，内容较简洁，颗粒度为 测试用例。"),a("font",{attrs:{color:"#E6A23C"}},[a("em",[_._v("--仅allure报告生成失败时提供")])])],1),_._v(" "),a("li",[_._v("allure：allure-pytest生成的报告，内容较丰富，颗粒度为 测试步骤，且包含步骤请求、响应、结果校验、变量提取等详细信息。")]),_._v(" "),a("li",[_._v("Log：执行当前测试时的全量日志信息。")])])]),_._v(" "),a("li",[_._v("阻塞：故障接口数统计\n"),a("ul",[a("li",[_._v("点击阻塞接口数量，弹窗阻塞接口列表详情\n"),a("img",{attrs:{src:v(344),alt:"An image"}})]),_._v(" "),a("li",[_._v("点击接口描述，可查看接口所属用例集->用例->步骤\n"),a("img",{attrs:{src:v(345),alt:"An image"}})]),_._v(" "),a("li",[_._v("点击Allure打开allure报告页面，-> behaviors: 查询用例名称可查到对应步骤的详细执行信息\n"),a("img",{attrs:{src:v(346),alt:"An image"}})])])])]),_._v(" "),a("h3",{attrs:{id:"_4-3-任务管理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-任务管理"}},[_._v("#")]),_._v(" 4.3 任务管理")]),_._v(" "),a("p",[_._v("记录构建执行中的任务以及历史任务，体现构建执行进度，能查看后端执行日志。(TODO 2022Q2)")]),_._v(" "),a("h2",{attrs:{id:"_5-数据库设计"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-数据库设计"}},[_._v("#")]),_._v(" 5. 数据库设计")]),_._v(" "),a("h3",{attrs:{id:"_5-1-测试环境监控-testenvmonitor"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-测试环境监控-testenvmonitor"}},[_._v("#")]),_._v(" 5.1 测试环境监控（TestEnvMonitor）")]),_._v(" "),a("p",[_._v("记录对应测试环境的最新可用性验证构建结果")]),_._v(" "),a("table",[a("thead",[a("tr",[a("th",[_._v("字段名称")]),_._v(" "),a("th",[_._v("数据类型")]),_._v(" "),a("th",[_._v("长度")]),_._v(" "),a("th",[_._v("可空")]),_._v(" "),a("th",[_._v("默认值")]),_._v(" "),a("th",[_._v("备注")])])]),_._v(" "),a("tbody",[a("tr",[a("td",[_._v("id")]),_._v(" "),a("td",[_._v("自增")]),_._v(" "),a("td"),_._v(" "),a("td"),_._v(" "),a("td"),_._v(" "),a("td",[_._v("主键")])]),_._v(" "),a("tr",[a("td",[_._v("env")]),_._v(" "),a("td",[_._v("外键")]),_._v(" "),a("td"),_._v(" "),a("td",[_._v("False")]),_._v(" "),a("td"),_._v(" "),a("td",[_._v("关联环境")])]),_._v(" "),a("tr",[a("td",[_._v("report")]),_._v(" "),a("td",[_._v("外键")]),_._v(" "),a("td"),_._v(" "),a("td",[_._v("True")]),_._v(" "),a("td"),_._v(" "),a("td",[_._v("关联测试报告")])]),_._v(" "),a("tr",[a("td",[_._v("creator")]),_._v(" "),a("td",[_._v("外键User")]),_._v(" "),a("td"),_._v(" "),a("td"),_._v(" "),a("td"),_._v(" "),a("td",[_._v("创建者")])])])]),_._v(" "),a("h2",{attrs:{id:"_6-接口设计"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-接口设计"}},[_._v("#")]),_._v(" 6. 接口设计")]),_._v(" "),a("h3",{attrs:{id:"_6-1-外部接口"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-1-外部接口"}},[_._v("#")]),_._v(" 6.1 外部接口")]),_._v(" "),a("h4",{attrs:{id:"_6-1-1-接口说明"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-1-1-接口说明"}},[_._v("#")]),_._v(" 6.1.1 接口说明")]),_._v(" "),a("table",[a("thead",[a("tr",[a("th",[_._v("Method")]),_._v(" "),a("th",[_._v("Path")]),_._v(" "),a("th",[_._v("Data")]),_._v(" "),a("th",[_._v("描述")])])]),_._v(" "),a("tbody",[a("tr",[a("td",[_._v("GET")]),_._v(" "),a("td",[_._v("/api_test/test/env_monitor/list")]),_._v(" "),a("td",[_._v("--")]),_._v(" "),a("td",[_._v("获取记录列表")])]),_._v(" "),a("tr",[a("td",[_._v("POST")]),_._v(" "),a("td",[_._v("/api_test/test/env_monitor/add")]),_._v(" "),a("td",[_._v("data")]),_._v(" "),a("td",[_._v("新增一条记录")])]),_._v(" "),a("tr",[a("td",[_._v("PATCH")]),_._v(" "),a("td",[_._v("/api_test/test/env_monitor/update")]),_._v(" "),a("td",[_._v("pk,data")]),_._v(" "),a("td",[_._v("编辑修改记录")])]),_._v(" "),a("tr",[a("td",[_._v("DELETE")]),_._v(" "),a("td",[_._v("/api_test/test/env_monitor/del")]),_._v(" "),a("td",[_._v("pk")]),_._v(" "),a("td",[_._v("删除一条记录")])])])]),_._v(" "),a("h4",{attrs:{id:"_6-1-2-调用方式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-1-2-调用方式"}},[_._v("#")]),_._v(" 6.1.2 调用方式")])])}),[],!1,null,null,null);t.default=s.exports}}]);